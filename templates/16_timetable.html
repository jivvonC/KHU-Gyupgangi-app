{% with messages = get_flashed_messages()%}
    {%if messages%}
    <script>
        alert("{{messages[-1]}}")
    </script>
    {%endif%}
{%endwith%}

<!doctype html>
<html>
    <style>
        table {
            border : 1px solid black;
            border-collapse: collapse;
            width: 100%;
            font-size: 12px; /* í°íŠ¸ í¬ê¸° ì¡°ì • */
        }
        
        th, td {
            border: none;
            text-align: center;
            height: 10px; /* ë†’ì´ë¥¼ 10pxë¡œ ì¡°ì • */
            padding: 2px; /* ì…€ ì•ˆìª½ ì—¬ë°± ì¡°ì • */
        }
        
        th {
            background-color: lightgray; /* í—¤ë” ë°°ê²½ìƒ‰ ë³€ê²½ */
            border: 1px solid black;
        }
        
        .class-cell {
            background-color: lightblue; /* ì‹œê°„í‘œ ì…€ì˜ ë°°ê²½ìƒ‰ ë³€ê²½ */
        }
        
        .time-cell {
            border: 1px solid black;
            vertical-align: top; /* ì…€ ë‚´ìš© ìœ„ìª½ ì •ë ¬ */
        }
    </style>
    
    <h1>ë‚´ ì‹œê°„í‘œ&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<a href="/enternew"><button>â•</button></a></h1>
    <body>
        <h1>{{username}}</h1>
        <h3>ê°•ì˜ ë¦¬ìŠ¤íŠ¸</h3>
        <p>ì´ë²ˆ í•™ê¸° ìˆ˜ê°•í•™ì : {{ totalCredits["sum(credits)"] }}</p>
        {% for row in rows %}
            {% if username == row["user_id"] %}
            <ul>
                <li>{{ row["id"] }}/{{ row["name"] }}/{{ row["prof"] }}/{{ row["time1"] }}/{{ row["time2"] }}/{{ row["credits"] }}í•™ì /{{ row["year"] }}í•™ë…„
                    <form action="{{ url_for('delsubject') }}" method='POST' style="display: inline;">
                        <input type="hidden" value="{{ row["id"] }}" name="id" />
                        <input type="submit" value="ğŸ—‘ï¸" />
                    </form>
                </li>
            </ul>
            {% endif %}
        {% endfor %}
        <a href="/hello">Go back to home page</a>


        <table border="1">
            <caption style="font-size: 14px;">2024ë…„ 1í•™ê¸°</caption>
            <tr>
                <th>ì‹œê°„</th>
                <th>ì›”</th>
                <th>í™”</th>
                <th>ìˆ˜</th>
                <th>ëª©</th>
                <th>ê¸ˆ</th>
            </tr>
            
            {% set checkMon = check.copy() %}
            {% set checkTue = check.copy() %}
            {% set checkWed = check.copy() %}
            {% set checkThu = check.copy() %}
            {% set checkFri = check.copy() %}

            {% for hour in range(9, 19) %}
                {% for minute in range(0, 60, 5) %}
                <tr>
                    {% if minute == 0 %}
                        <td class="time-cell" rowspan="12">{{ "%02d:00" | format(hour) }}</td>
                    {% endif %}

                    {% for day, checkDay in [('ì›”', checkMon), ('í™”', checkTue), ('ìˆ˜', checkWed), ('ëª©', checkThu), ('ê¸ˆ', checkFri)] %}
                        {% set ind = (hour - 9) * 12 + minute // 5 %}
                        {% set lecture = result[day][ind] %}
                        {% if lecture %}
                            {% if lecture['number'] in checkDay %}
                                {% set check_index = checkDay.index(lecture['number']) %}
                                {% set check_item = checkDay.pop(check_index) %}
                                {% if result[day][ind] == result[day][ind + 1] %}
                                    <td class="class-cell" rowspan="{{ lecture['unit'] }}">{{ lecture['subject'] }}, {{ lecture['teacher'] }}</td>
                                {% else %}
                                    <td class="class-cell">2</td>
                                {% endif %}
                            {% else %}
                                {% if result[day][ind] == result[day][ind - 1] %}
                                    {# ë³‘í•©ëœ í–‰ì˜ ê²½ìš° ë¹ˆ ì…€ì„ ì¶œë ¥í•˜ì§€ ì•ŠìŒ #}
                                {% else %}
                                    <td class="class-cell">4</td>
                                {% endif %}
                            {% endif %}
                        {% else %}
                            <td></td>
                        {% endif %}
                    {% endfor %}
                </tr>
                {% endfor %}
            {% endfor %}
        </table>
    </body>
    </body>
</html>